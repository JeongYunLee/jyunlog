<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/2023-03-15-wikibabeintegrator/_payload.json"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/entry.4e7d7028.js"><link rel="preload" as="style" href="/_nuxt/entry.2d6a5e6f.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/default.1b9633cf.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/nuxt-link.45d771fa.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/SocialIcon.88a97b00.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Icon.d95917a5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/config.743a99d3.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/SectionContainer.7cef994a.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/components.080fc96a.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/_...slug_.be8b5c98.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/asyncData.76c6485f.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/query.4ec822fa.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/utils.207ba645.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/preview.9940d34f.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/post.8ac4c742.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/PageTitle.3172c02d.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/nuxt-img.8a7090da.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRenderer.12560e93.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.5018b834.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/index.a6ef77ff.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Tag.49d16a8b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/kebabCase.4e53e42d.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH3.335d239e.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseEm.14ff99cc.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseP.616dbe3f.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseImg.c587e382.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseBlockquote.768e667b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseUl.9c17b126.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseLi.169ac455.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseA.bbebd276.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH2.2ce8742b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH4.3af9a518.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCodeInline.f7545f45.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseOl.143621ef.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCode.872aa10f.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/author.22269ac1.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/list.943e7c34.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/formatDate.80c1adf5.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/postSimple.58457403.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/error-component.02390ede.js"><link rel="stylesheet" href="/_nuxt/entry.2d6a5e6f.css"><style>.icon[data-v-f43f2976]{display:inline-block;vertical-align:middle}</style><style>pre code .line{display:block;min-height:1rem}</style><script>"use strict";const w=window,de=document.documentElement,knownColorSchemes=["dark","light"],preference=window.localStorage.getItem("nuxt-color-mode")||"system";let value=preference==="system"?getColorScheme():preference;const forcedColorMode=de.getAttribute("data-color-mode-forced");forcedColorMode&&(value=forcedColorMode),addColorScheme(value),w["__NUXT_COLOR_MODE__"]={preference,value,getColorScheme,addColorScheme,removeColorScheme};function addColorScheme(e){const o=""+e+"",t="";de.classList?de.classList.add(o):de.className+=" "+o,t&&de.setAttribute("data-"+t,e)}function removeColorScheme(e){const o=""+e+"",t="";de.classList?de.classList.remove(o):de.className=de.className.replace(new RegExp(o,"g"),""),t&&de.removeAttribute("data-"+t)}function prefersColorScheme(e){return w.matchMedia("(prefers-color-scheme"+e+")")}function getColorScheme(){if(w.matchMedia&&prefersColorScheme("").media!=="not all"){for(const e of knownColorSchemes)if(prefersColorScheme(":"+e).matches)return e}return"light"}
</script></head>
<body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__nuxt"><!--[--><!--[--><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><!--[--><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a href="/" class="" aria-label="TailwindBlog"></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><!--[--><a href="/" class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4">About</a><a href="/blog" class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4">Blog</a><a href="/tags" class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4">Tags</a><a href="/projects" class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4">Projects</a><a href="/Latest" class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4">Latest</a><!--]--></div><!--[--><button type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4">(*.*)</button><!--]--><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fillRule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clipRule="evenodd"></path></svg></button><div class="translate-x-full fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><!--[--><div class="px-12 py-4"><a href="/" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">About</a></div><div class="px-12 py-4"><a href="/blog" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">Blog</a></div><div class="px-12 py-4"><a href="/tags" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">Tags</a></div><div class="px-12 py-4"><a href="/projects" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">Projects</a></div><div class="px-12 py-4"><a href="/Latest" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">Latest</a></div><!--]--></nav></div></div></div></header><main class="mb-auto"><!--[--><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><!--[--><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clipRule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clipRule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="{date}">Wednesday, March 15, 2023</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14"><!--[-->&lt;Mediawiki-3&gt; WikibaseIntegrator로 csv 임포트하기<!--]--></h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr;"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><!--[--><li class="flex items-center space-x-2"><img src="/_ipx/s_38x38/static/images/img.jpeg" onerror="this.setAttribute(&#39;data-error&#39;, 1)" width="38" height="38" alt="avatar" data-nuxt-img class="h-10 w-10 rounded-full"><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">JeongYun Lee</dd><dt class="sr-only">Twitter</dt><dd><!----></dd></dl></li><!--]--></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><div><div style="color:#F08080;border-radius:10px;text-align:center;">
    <h3><!--[--><em><!--[--><span style="color:#F08080;">❝</span><!--]--></em><!--]--></h3>
    <h3><!--[--><em><!--[--><span style="color:#F08080;">2023-08-12에 수정된 문서 입니다</span><!--]--></em><!--]--></h3>
    <h3><!--[--><em><!--[--><span style="color:#F08080;">❞</span><!--]--></em><!--]--></h3></div><p><!--[--><img src="/images/blogImg/2023-03-15-1.png" alt="wikibase-main"><!--]--></p><blockquote><!--[--><ul><!--[--><li><!--[-->환경: MacOS (M2)<!--]--></li><li><!--[-->참고자료: <a href="https://github.com/SemanticLab/data-2-wikibase" rel="nofollow"><!--[-->깃헙<!--]--></a>, <a href="https://learningwikibase.com/data-import/" rel="nofollow"><!--[-->가이드<!--]--></a><!--]--></li><!--]--></ul><!--]--></blockquote><h2 id="_1-가상환경-설정"><a href="#_1-가상환경-설정"><!--[-->1. 가상환경 설정<!--]--></a></h2><div style="background:#e4f0db;padding:1%;border-radius:10px;">
    <h4><!--[-->✔️ 가상환경에서 설치해야 하는 이유<!--]--></h4>
    <ul><!--[-->
        <li><!--[-->pywikibot을 `pip isntall pywikibot` 했을 때는 local의 wikibase와 연결하기 위해서 포트 번호 변경하는 파일을 수정해줄 수 없음.<!--]--></li>
        <li><!--[-->pywikibot 깃헙을 클론해서 (파일이름 core) 하위 파일들 수정하고(아래 참고) 가상환경에서 불러와서 모듈 임포트해서 해결<!--]--></li>
        <li><!--[-->기본 가상환경(?) 만들어서 해도 되는데, 연결이 잘 안돼서 아니콘다에서 가상환경 만든 것 (로컬 python kernel 연결이 뭔가 꼬인 듯. 그냥 가상환경 만들어서 연결 잘 되면 아나콘다에서 안만들어도 됨)<!--]--></li>
    <!--]--></ul></div><h4 id="_11-아나콘다-가상환경-설정1"><a href="#_11-아나콘다-가상환경-설정1"><!--[-->1.1 아나콘다 가상환경 설정<sup><a aria-current="page" href="/blog/2023-03-15-wikibabeintegrator#user-content-fn-1" class="router-link-active router-link-exact-active" aria-describedby="footnote-label" data-footnote-ref="true" id="user-content-fnref-1"><!--[-->1<!--]--></a></sup><!--]--></a></h4><ul><!--[--><li><!--[--><code><!--[-->conda create -n wikibase python=3.7<!--]--></code><!--]--></li><li><!--[-->가상환경 실행하기 <code><!--[-->conda activate wikibase<!--]--></code><!--]--></li><!--]--></ul><p><!--[-->terminal이랑 jupyter notebook kernel이랑 둘다 가상환경으로 설정됐는지 확인해야 합니다.<!--]--></p><h2 id="_2-github-repo만들어서-clone"><a href="#_2-github-repo만들어서-clone"><!--[-->2. github repo만들어서 clone<!--]--></a></h2><ul><!--[--><li><!--[-->clone한 폴더에 ipynb 파일 하나 만들고 가상환경 kerneldmfh 접속하기<!--]--></li><!--]--></ul><h2 id="_3-pywikibot-설치하기"><a href="#_3-pywikibot-설치하기"><!--[-->3. pywikibot 설치하기<!--]--></a></h2><h3 id="_31-pywikibot-git-clone2"><a href="#_31-pywikibot-git-clone2"><!--[-->3.1. pywikibot git clone<sup><a aria-current="page" href="/blog/2023-03-15-wikibabeintegrator#user-content-fn-2" class="router-link-active router-link-exact-active" aria-describedby="footnote-label" data-footnote-ref="true" id="user-content-fnref-2"><!--[-->2<!--]--></a></sup><!--]--></a></h3><ul><!--[--><li><!--[--><code><!--[-->git clone https://gerrit.wikimedia.org/r/pywikibot/core.git<!--]--></code><!--]--></li><!--]--></ul><h3 id="_32-추가-설치하기"><a href="#_32-추가-설치하기"><!--[-->3.2. 추가 설치하기<!--]--></a></h3><ol><!--[--><li><!--[--><code><!--[-->pip install requests<!--]--></code><!--]--></li><li><!--[--><code><!--[-->pip install -r requirements.txt<!--]--></code><!--]--></li><li><!--[-->cd core 들어가서 <code><!--[-->git submodule update --init<!--]--></code> → 조금 오래걸립니다.<!--]--></li><li><!--[--><code><!--[-->python pwb.py login -all<!--]--></code> 이 코드를 치면 아래와 같은 화면이 출력되면서 새로 생성을 시작합니다.
<img src="/images/blogImg/2023-03-15-3.png" alt="pwb.py" width="70%" title="python pwb.py login -all"><ul><!--[--><li><!--[-->family 선택할 때 mediawiki로 진행<!--]--></li><li><!--[-->username, bot name, bot password 치고 나서 &#39;Do you want to select framework setting sections?&#39;과 &#39;Do you want to select scripts setting sections?&#39; 질문이 나왔을 때 다 a(전체 다 선택함) 누르면 <a href="http://user-config.py" rel="nofollow"><!--[-->user-config.py<!--]--></a> 파일 생성 완료됩니다.<!--]--></li><!--]--></ul><!--]--></li><!--]--></ol><h3 id="_33-coreuser-configpy-파일-수정하기"><a href="#_33-coreuser-configpy-파일-수정하기"><!--[-->3.3. core/user-config.py 파일 수정하기<!--]--></a></h3><ul><!--[--><li><!--[--><a href="http://user-config.py" rel="nofollow"><!--[-->user-config.py<!--]--></a> 파일 잘 생성되었는지 확인합니다.<!--]--></li><li><!--[-->추가 수정<ul><!--[--><li><!--[--><code><!--[-->family_files[&#39;wikipedia&#39;] = &#39;[http://localhost:4100/](http://localhost:4100/)&#39;<!--]--></code> 추가 (port number는 직접 수정)<!--]--></li><li><!--[-->password_file 경로 지정<!--]--></li><li><!--[-->mylang 에 다른 언어도 넣어주고 싶다면 똑같은 형식으로 넣으면 됨 (ex. <code><!--[-->mylnag = &#39;ko&#39;<!--]--></code>)
<img src="/images/blogImg/2023-03-15-4.png" alt="editUser-config" width="70%" title="user-config.py파일 수정"><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><h3 id="_34-coreuser-passwordpy-파일-수정하기"><a href="#_34-coreuser-passwordpy-파일-수정하기"><!--[-->3.4. core/user-password.py 파일 수정하기<!--]--></a></h3><ul><!--[--><li><!--[-->형식이 아래와 다르게 저장되어 있을 수 있습니다. 아래와 같은 형식으로 수정하세요.
<img src="/images/blogImg/2023-03-15-5.png" alt="user-password" width="70%" title="user-password"><!--]--></li><!--]--></ul><h3 id="_35-corepywikibotconfigpy-파일-수정하기"><a href="#_35-corepywikibotconfigpy-파일-수정하기"><!--[-->3.5. core/pywikibot/config.py 파일 수정하기<!--]--></a></h3><ul><!--[--><li><!--[-->user_config_file 변수에 get_user_confifg_file() 함수 쓰지 말고 그냥 <a href="http://user-config.py" rel="nofollow"><!--[-->user-config.py<!--]--></a> 경로로 바로 넣어주세요.
<img src="/images/blogImg/2023-03-15-6.png" alt="user-config-file" width="70%" title="user-config-file"><!--]--></li><!--]--></ul><h2 id="_4-ipynb-connect"><a href="#_4-ipynb-connect"><!--[-->4. ipynb: CONNECT<!--]--></a></h2><p><!--[-->지금부터는 python의 ipynb 파일에서 진행하는 내용입니다. 아래 코드들은 모두 이 깃헙<sup><a aria-current="page" href="/blog/2023-03-15-wikibabeintegrator#user-content-fn-3" class="router-link-active router-link-exact-active" aria-describedby="footnote-label" data-footnote-ref="true" id="user-content-fnref-3"><!--[-->3<!--]--></a></sup>을 참고하였습니다.<!--]--></p><ol><!--[--><li><!--[-->core의 경로를 sys.path에 추가<!--]--></li><!--]--></ol><!--[--><pre><code><span class="line" line="1"><span class="ct-794887">import</span><span class="ct-836158"> sys
</span></span><span class="line" line="2"><span>
</span></span><span class="line" line="3"><span class="ct-836158">sys.path.append(</span><span class="ct-169668">&#39;/Users/jeongyunl/Documents/GitHub/wikibaseIntegrator_jyl/core&#39;</span><span class="ct-836158">)
</span></span><span class="line" line="4"><span class="ct-363298">print</span><span class="ct-836158">(sys.path)</span></span></code></pre><!--]--><ol start="2"><!--[--><li><!--[-->local wikibase 연결하기<!--]--></li><!--]--></ol><!--[--><pre><code><span class="line" line="1"><span class="ct-794887">from</span><span class="ct-836158"> wikibaseintegrator </span><span class="ct-794887">import</span><span class="ct-836158"> WikibaseIntegrator
</span></span><span class="line" line="2"><span class="ct-794887">from</span><span class="ct-836158"> wikibaseintegrator.wbi_config </span><span class="ct-794887">import</span><span class="ct-836158"> config </span><span class="ct-794887">as</span><span class="ct-836158"> wbi_config
</span></span><span class="line" line="3"><span>
</span></span><span class="line" line="4"><span class="ct-836158">wbi_config[</span><span class="ct-169668">&#39;MEDIAWIKI_API_URL&#39;</span><span class="ct-836158">] </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;http://localhost:4100/w/api.php&#39;
</span></span><span class="line" line="5"><span class="ct-836158">wbi_config[</span><span class="ct-169668">&#39;SPARQL_ENDPOINT_URL&#39;</span><span class="ct-836158">] </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;http://localhost:8834/proxy/wdqs/bigdata/namespace/wdq/sparql&#39;
</span></span><span class="line" line="6"><span class="ct-836158">wbi_config[</span><span class="ct-169668">&#39;WIKIBASE_URL&#39;</span><span class="ct-836158">] </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;http://wikibase.svc&#39;
</span></span><span class="line" line="7"><span class="ct-836158">wbi_config[</span><span class="ct-169668">&#39;USER_AGENT&#39;</span><span class="ct-836158">] </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;MyWikibaseBot/1.0 (https://www.wikidata.org/wiki/User:JeongYun Lee)&#39;</span></span></code></pre><!--]--><ol start="3"><!--[--><li><!--[-->login<!--]--></li><!--]--></ol><!--[--><pre><code><span class="line" line="1"><span class="ct-794887">from</span><span class="ct-836158"> wikibaseintegrator </span><span class="ct-794887">import</span><span class="ct-836158"> wbi_login
</span></span><span class="line" line="2"><span>
</span></span><span class="line" line="3"><span class="ct-836158">login_instance </span><span class="ct-794887">=</span><span class="ct-836158"> wbi_login.Login(</span><span class="ct-402719">user</span><span class="ct-794887">=</span><span class="ct-169668">&#39;JeongYun Lee&#39;</span><span class="ct-836158">, </span><span class="ct-402719">password</span><span class="ct-794887">=</span><span class="ct-169668">&#39;*****&#39;</span><span class="ct-836158">, </span><span class="ct-402719">mediawiki_api_url</span><span class="ct-794887">=</span><span class="ct-169668">&#39;http://localhost:4100/w/api.php&#39;</span><span class="ct-836158">)</span></span></code></pre><!--]--><ol start="4"><!--[--><li><!--[-->pywikibot install<!--]--></li><!--]--></ol><!--[--><pre><code><span class="line" line="1"><span>
</span></span><span class="line" line="2"><span class="ct-794887">import</span><span class="ct-836158"> pywikibot, json, csv, sys
</span></span><span class="line" line="3"><span class="ct-794887">from</span><span class="ct-836158"> pywikibot </span><span class="ct-794887">import</span><span class="ct-836158"> family</span></span></code></pre><!--]--><h2 id="_5-ipynb-add-properties"><a href="#_5-ipynb-add-properties"><!--[-->5. ipynb: ADD PROPERTIES<!--]--></a></h2><!--[--><pre><code><span class="line" line="1"><span class="ct-169668">&quot;&quot;&quot;
</span></span><span class="line" line="2"><span class="ct-169668">    Notes:
</span></span><span class="line" line="3"><span class="ct-169668">    We need to remove the built in throttling because we
</span></span><span class="line" line="4"><span class="ct-169668">    are working on our own localhost running wikibase, we don&#39;t
</span></span><span class="line" line="5"><span class="ct-169668">    care if we do a ton of requests, we are likely the only user
</span></span><span class="line" line="6"><span class="ct-169668">&quot;&quot;&quot;
</span></span><span class="line" line="7"><span class="ct-068318"># over write it
</span></span><span class="line" line="8"><span class="ct-854774">def</span><span class="ct-836158"> </span><span class="ct-417962">wait</span><span class="ct-836158">(</span><span class="ct-341470">self</span><span class="ct-836158">, </span><span class="ct-341470">seconds</span><span class="ct-836158">):
</span></span><span class="line" line="9"><span class="ct-836158">    </span><span class="ct-169668">&quot;&quot;&quot;Wait for seconds seconds.
</span></span><span class="line" line="10"><span class="ct-169668">    Announce the delay if it exceeds a preset limit.
</span></span><span class="line" line="11"><span class="ct-169668">    &quot;&quot;&quot;
</span></span><span class="line" line="12"><span class="ct-836158">    </span><span class="ct-794887">pass
</span></span><span class="line" line="13"><span>
</span></span><span class="line" line="14"><span class="ct-836158">pywikibot.throttle.Throttle.wait </span><span class="ct-794887">=</span><span class="ct-836158"> wait
</span></span><span class="line" line="15"><span>
</span></span><span class="line" line="16"><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-869604">__name__</span><span class="ct-836158"> </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&quot;__main__&quot;</span><span class="ct-836158">:
</span></span><span class="line" line="17"><span>
</span></span><span class="line" line="18"><span class="ct-836158">    csv_path </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;/Users/jeongyunl/Documents/GitHub/wikibaseIntegrator_address_test2/testData/add_properties.csv&#39;
</span></span><span class="line" line="19"><span class="ct-836158">    csv_file </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path,</span><span class="ct-169668">&#39;r&#39;</span><span class="ct-836158">, </span><span class="ct-402719">encoding</span><span class="ct-794887">=</span><span class="ct-169668">&#39;utf-8-sig&#39;</span><span class="ct-836158">)
</span></span><span class="line" line="20"><span class="ct-836158">    csv_reader </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictReader(csv_file)
</span></span><span class="line" line="21"><span>
</span></span><span class="line" line="22"><span class="ct-836158">      </span><span class="ct-068318">### 로그인 이미 했으므로 안해도 됨
</span></span><span class="line" line="23"><span class="ct-836158">    site </span><span class="ct-794887">=</span><span class="ct-836158"> pywikibot.Site(</span><span class="ct-169668">&#39;mediawiki:mediawiki&#39;</span><span class="ct-836158">)
</span></span><span class="line" line="24"><span class="ct-836158">    </span><span class="ct-068318">#site.login()
</span></span><span class="line" line="25"><span>
</span></span><span class="line" line="26"><span class="ct-836158">    complete_data </span><span class="ct-794887">=</span><span class="ct-836158"> []
</span></span><span class="line" line="27"><span>
</span></span><span class="line" line="28"><span class="ct-836158">    </span><span class="ct-794887">for</span><span class="ct-836158"> row </span><span class="ct-794887">in</span><span class="ct-836158"> csv_reader:
</span></span><span class="line" line="29"><span class="ct-836158">        row </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">dict</span><span class="ct-836158">(row)
</span></span><span class="line" line="30"><span>
</span></span><span class="line" line="31"><span class="ct-836158">        data </span><span class="ct-794887">=</span><span class="ct-836158"> {
</span></span><span class="line" line="32"><span class="ct-836158">            </span><span class="ct-169668">&#39;datatype&#39;</span><span class="ct-836158">: row[</span><span class="ct-169668">&#39;Datatype&#39;</span><span class="ct-836158">],  </span><span class="ct-068318"># mandatory
</span></span><span class="line" line="33"><span class="ct-836158">            </span><span class="ct-169668">&#39;descriptions&#39;</span><span class="ct-836158">: {
</span></span><span class="line" line="34"><span class="ct-836158">                </span><span class="ct-169668">&#39;ko&#39;</span><span class="ct-836158">: {
</span></span><span class="line" line="35"><span class="ct-836158">                    </span><span class="ct-169668">&#39;language&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;ko&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="36"><span class="ct-836158">                    </span><span class="ct-169668">&#39;value&#39;</span><span class="ct-836158">: row[</span><span class="ct-169668">&#39;Property Description&#39;</span><span class="ct-836158">]
</span></span><span class="line" line="37"><span class="ct-836158">                }
</span></span><span class="line" line="38"><span class="ct-836158">            },
</span></span><span class="line" line="39"><span class="ct-836158">            </span><span class="ct-169668">&#39;labels&#39;</span><span class="ct-836158">: {
</span></span><span class="line" line="40"><span class="ct-836158">                </span><span class="ct-169668">&#39;ko&#39;</span><span class="ct-836158">: {
</span></span><span class="line" line="41"><span class="ct-836158">                    </span><span class="ct-169668">&#39;language&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;ko&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="42"><span class="ct-836158">                    </span><span class="ct-169668">&#39;value&#39;</span><span class="ct-836158">: row[</span><span class="ct-169668">&#39;Property Label&#39;</span><span class="ct-836158">]
</span></span><span class="line" line="43"><span class="ct-836158">                }
</span></span><span class="line" line="44"><span class="ct-836158">            }
</span></span><span class="line" line="45"><span class="ct-836158">        }
</span></span><span class="line" line="46"><span>
</span></span><span class="line" line="47"><span class="ct-836158">        params </span><span class="ct-794887">=</span><span class="ct-836158"> {
</span></span><span class="line" line="48"><span class="ct-836158">            </span><span class="ct-169668">&#39;action&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;wbeditentity&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="49"><span class="ct-836158">            </span><span class="ct-169668">&#39;new&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;property&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="50"><span class="ct-836158">            </span><span class="ct-169668">&#39;data&#39;</span><span class="ct-836158">: json.dumps(data),
</span></span><span class="line" line="51"><span class="ct-836158">            </span><span class="ct-169668">&#39;summary&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;bot adding in properties&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="52"><span class="ct-836158">            </span><span class="ct-169668">&#39;token&#39;</span><span class="ct-836158">: site.tokens[</span><span class="ct-169668">&#39;csrf&#39;</span><span class="ct-836158">]
</span></span><span class="line" line="53"><span class="ct-836158">            </span><span class="ct-068318"># &#39;token&#39;: site.tokens[&#39;edit&#39;]
</span></span><span class="line" line="54"><span class="ct-836158">        }
</span></span><span class="line" line="55"><span>
</span></span><span class="line" line="56"><span class="ct-836158">        req </span><span class="ct-794887">=</span><span class="ct-836158"> site._simple_request(</span><span class="ct-794887">**</span><span class="ct-836158">params)
</span></span><span class="line" line="57"><span class="ct-836158">        results </span><span class="ct-794887">=</span><span class="ct-836158"> req.submit()
</span></span><span class="line" line="58"><span>
</span></span><span class="line" line="59"><span class="ct-836158">        row[</span><span class="ct-169668">&#39;PID&#39;</span><span class="ct-836158">] </span><span class="ct-794887">=</span><span class="ct-836158"> results[</span><span class="ct-169668">&#39;entity&#39;</span><span class="ct-836158">][</span><span class="ct-169668">&#39;id&#39;</span><span class="ct-836158">]
</span></span><span class="line" line="60"><span>
</span></span><span class="line" line="61"><span class="ct-836158">        </span><span class="ct-363298">print</span><span class="ct-836158">(row[</span><span class="ct-169668">&#39;PID&#39;</span><span class="ct-836158">], row[</span><span class="ct-169668">&#39;Property Label&#39;</span><span class="ct-836158">])
</span></span><span class="line" line="62"><span class="ct-836158">        complete_data.append(row)
</span></span><span class="line" line="63"><span>
</span></span><span class="line" line="64"><span class="ct-836158">    csv_file.close()
</span></span><span class="line" line="65"><span>
</span></span><span class="line" line="66"><span class="ct-836158">    </span><span class="ct-794887">with</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path</span><span class="ct-794887">+</span><span class="ct-169668">&#39;_updated.csv&#39;</span><span class="ct-836158">,</span><span class="ct-169668">&#39;w&#39;</span><span class="ct-836158">) </span><span class="ct-794887">as</span><span class="ct-836158"> out:
</span></span><span class="line" line="67"><span>
</span></span><span class="line" line="68"><span class="ct-836158">        fieldnames </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">list</span><span class="ct-836158">(complete_data[</span><span class="ct-360247">0</span><span class="ct-836158">].keys())
</span></span><span class="line" line="69"><span class="ct-836158">        writer </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictWriter(out, </span><span class="ct-402719">fieldnames</span><span class="ct-794887">=</span><span class="ct-836158">fieldnames)
</span></span><span class="line" line="70"><span>
</span></span><span class="line" line="71"><span class="ct-836158">        writer.writeheader()
</span></span><span class="line" line="72"><span class="ct-836158">        writer.writerows(complete_data)</span></span></code></pre><!--]--><h2 id="_6-ipynb-add-core-items"><a href="#_6-ipynb-add-core-items"><!--[-->6. ipynb: ADD CORE ITEMS<!--]--></a></h2><!--[--><pre><code><span class="line" line="1"><span class="ct-794887">import</span><span class="ct-836158"> wikidataintegrator </span><span class="ct-794887">as</span><span class="ct-836158"> </span><span class="ct-360247">WI
</span></span><span class="line" line="2"><span class="ct-794887">import</span><span class="ct-836158"> requests, csv, sys, re
</span></span><span class="line" line="3"><span>
</span></span><span class="line" line="4"><span class="ct-068318">########## part1 ##########
</span></span><span class="line" line="5"><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDItemEngine.core_props </span><span class="ct-794887">=</span><span class="ct-836158"> {
</span></span><span class="line" line="6"><span class="ct-836158">    </span><span class="ct-169668">&#39;P50&#39;</span><span class="ct-836158">: {
</span></span><span class="line" line="7"><span class="ct-836158">        </span><span class="ct-169668">&#39;datatype&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;string&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="8"><span class="ct-836158">        </span><span class="ct-169668">&#39;name&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;식별자&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="9"><span class="ct-836158">        </span><span class="ct-169668">&#39;domain&#39;</span><span class="ct-836158">: [</span><span class="ct-169668">&#39;addresTerms&#39;</span><span class="ct-836158">], </span><span class="ct-068318"># this is a wikidataintergrator thing, to group properties together
</span></span><span class="line" line="10"><span class="ct-836158">        </span><span class="ct-169668">&#39;core_id&#39;</span><span class="ct-836158">: </span><span class="ct-360247">True
</span></span><span class="line" line="11"><span class="ct-836158">    }
</span></span><span class="line" line="12"><span class="ct-836158">}
</span></span><span class="line" line="13"><span>
</span></span><span class="line" line="14"><span class="ct-836158">use_unique_property </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;P50:string&#39;
</span></span><span class="line" line="15"><span>
</span></span><span class="line" line="16"><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-869604">__name__</span><span class="ct-836158"> </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&quot;__main__&quot;</span><span class="ct-836158">:
</span></span><span class="line" line="17"><span>
</span></span><span class="line" line="18"><span class="ct-836158">    csv_path </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;/Users/jeongyunl/Documents/Github/wikibaseintegrator_address_test2/testData/add_core_items.csv&#39;
</span></span><span class="line" line="19"><span class="ct-836158">    csv_file </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path,</span><span class="ct-169668">&#39;r&#39;</span><span class="ct-836158">, </span><span class="ct-402719">encoding</span><span class="ct-794887">=</span><span class="ct-169668">&#39;utf-8-sig&#39;</span><span class="ct-836158">)
</span></span><span class="line" line="20"><span class="ct-836158">    csv_reader </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictReader(csv_file)
</span></span><span class="line" line="21"><span>
</span></span><span class="line" line="22"><span class="ct-836158">    complete_data </span><span class="ct-794887">=</span><span class="ct-836158"> []
</span></span><span class="line" line="23"><span class="ct-836158">    errors_data </span><span class="ct-794887">=</span><span class="ct-836158"> []
</span></span><span class="line" line="24"><span>
</span></span><span class="line" line="25"><span class="ct-836158">    </span><span class="ct-794887">for</span><span class="ct-836158"> row </span><span class="ct-794887">in</span><span class="ct-836158"> csv_reader:
</span></span><span class="line" line="26"><span class="ct-836158">        row </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">dict</span><span class="ct-836158">(row)
</span></span><span class="line" line="27"><span>
</span></span><span class="line" line="28"><span class="ct-836158">        data </span><span class="ct-794887">=</span><span class="ct-836158"> []
</span></span><span class="line" line="29"><span>
</span></span><span class="line" line="30"><span class="ct-836158">        </span><span class="ct-068318"># properties stuff
</span></span><span class="line" line="31"><span class="ct-836158">        </span><span class="ct-794887">for</span><span class="ct-836158"> key </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="32"><span>
</span></span><span class="line" line="33"><span class="ct-836158">            </span><span class="ct-068318"># is it a property field
</span></span><span class="line" line="34"><span class="ct-836158">            </span><span class="ct-794887">if</span><span class="ct-836158"> key.find(</span><span class="ct-169668">&#39;:&#39;</span><span class="ct-836158">) </span><span class="ct-794887">&gt;</span><span class="ct-836158"> </span><span class="ct-794887">-</span><span class="ct-360247">1</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> key[</span><span class="ct-360247">0</span><span class="ct-836158">] </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&quot;P&quot;</span><span class="ct-836158">:
</span></span><span class="line" line="35"><span class="ct-836158">                </span><span class="ct-360247">PID</span><span class="ct-836158">, data_type </span><span class="ct-794887">=</span><span class="ct-836158"> key.split(</span><span class="ct-169668">&#39;:&#39;</span><span class="ct-836158">)
</span></span><span class="line" line="36"><span>
</span></span><span class="line" line="37"><span class="ct-836158">                </span><span class="ct-068318"># there are few other data types need to add...
</span></span><span class="line" line="38"><span class="ct-836158">                </span><span class="ct-794887">try</span><span class="ct-836158">:
</span></span><span class="line" line="39"><span class="ct-836158">                    </span><span class="ct-794887">if</span><span class="ct-836158"> data_type.lower() </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;string&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="40"><span class="ct-836158">                        </span><span class="ct-794887">if</span><span class="ct-836158"> row[key] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[key].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="41"><span class="ct-836158">                            statement </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDString(</span><span class="ct-402719">value</span><span class="ct-794887">=</span><span class="ct-836158">row[key], </span><span class="ct-402719">prop_nr</span><span class="ct-794887">=</span><span class="ct-360247">PID</span><span class="ct-836158">)
</span></span><span class="line" line="42"><span class="ct-836158">                            data.append(statement)
</span></span><span class="line" line="43"><span class="ct-836158">                    </span><span class="ct-794887">elif</span><span class="ct-836158"> data_type.lower() </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;url&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="44"><span class="ct-836158">                        </span><span class="ct-794887">if</span><span class="ct-836158"> row[key] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[key].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="45"><span class="ct-836158">                            statement </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDUrl(</span><span class="ct-402719">value</span><span class="ct-794887">=</span><span class="ct-836158">row[key], </span><span class="ct-402719">prop_nr</span><span class="ct-794887">=</span><span class="ct-360247">PID</span><span class="ct-836158">)
</span></span><span class="line" line="46"><span class="ct-836158">                            data.append(statement)
</span></span><span class="line" line="47"><span class="ct-836158">                    </span><span class="ct-794887">elif</span><span class="ct-836158"> data_type.lower() </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;wikibase-item&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="48"><span class="ct-836158">                        </span><span class="ct-794887">if</span><span class="ct-836158"> row[key] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[key].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="49"><span class="ct-836158">                            statement </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDItemID(</span><span class="ct-402719">value</span><span class="ct-794887">=</span><span class="ct-836158">row[key], </span><span class="ct-402719">prop_nr</span><span class="ct-794887">=</span><span class="ct-360247">PID</span><span class="ct-836158">)
</span></span><span class="line" line="50"><span class="ct-836158">                            data.append(statement)
</span></span><span class="line" line="51"><span>
</span></span><span class="line" line="52"><span>
</span></span><span class="line" line="53"><span class="ct-836158">                </span><span class="ct-794887">except</span><span class="ct-836158"> </span><span class="ct-363297">Exception</span><span class="ct-836158"> </span><span class="ct-794887">as</span><span class="ct-836158"> e:
</span></span><span class="line" line="54"><span class="ct-836158">                    </span><span class="ct-363298">print</span><span class="ct-836158">(</span><span class="ct-169668">&quot;There was an error with this part1, skipping:&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="55"><span class="ct-836158">                    </span><span class="ct-363298">print</span><span class="ct-836158">(row)
</span></span><span class="line" line="56"><span class="ct-836158">                    </span><span class="ct-363298">print</span><span class="ct-836158">(e)
</span></span><span class="line" line="57"><span class="ct-836158">                    errors_data.append(row)
</span></span><span class="line" line="58"><span class="ct-836158">                    data </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&quot;error&quot;
</span></span><span class="line" line="59"><span>
</span></span><span class="line" line="60"><span class="ct-836158">        </span><span class="ct-794887">if</span><span class="ct-836158"> data </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;error&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="61"><span class="ct-836158">            </span><span class="ct-794887">continue
</span></span><span class="line" line="62"><span>
</span></span><span class="line" line="63"><span class="ct-836158">        </span><span class="ct-794887">if</span><span class="ct-836158"> use_unique_property </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="64"><span class="ct-836158">            item_name </span><span class="ct-794887">=</span><span class="ct-836158"> row[use_unique_property]
</span></span><span class="line" line="65"><span class="ct-836158">        </span><span class="ct-794887">else</span><span class="ct-836158">:
</span></span><span class="line" line="66"><span class="ct-836158">            item_name </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">None
</span></span><span class="line" line="67"><span>
</span></span><span class="line" line="68"><span class="ct-068318">########## part2 ##########
</span></span><span class="line" line="69"><span class="ct-836158">        domain </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;addresTerms&#39;
</span></span><span class="line" line="70"><span>
</span></span><span class="line" line="71"><span class="ct-836158">        </span><span class="ct-794887">try</span><span class="ct-836158">:
</span></span><span class="line" line="72"><span class="ct-836158">            wd_item </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDItemEngine(</span><span class="ct-402719">new_item</span><span class="ct-794887">=</span><span class="ct-360247">True</span><span class="ct-836158">, </span><span class="ct-402719">data</span><span class="ct-794887">=</span><span class="ct-836158">data, </span><span class="ct-402719">mediawiki_api_url</span><span class="ct-794887">=</span><span class="ct-169668">&quot;http://localhost:4100/w/api.php&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="73"><span>
</span></span><span class="line" line="74"><span class="ct-836158">            </span><span class="ct-068318"># set the label and description if exists
</span></span><span class="line" line="75"><span class="ct-836158">            </span><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158"> </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="76"><span class="ct-836158">                </span><span class="ct-794887">if</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="77"><span class="ct-836158">                    wd_item.set_label(row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">])
</span></span><span class="line" line="78"><span>
</span></span><span class="line" line="79"><span class="ct-836158">            </span><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158"> </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="80"><span class="ct-836158">                </span><span class="ct-794887">if</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158">] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158">].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="81"><span class="ct-836158">                    wd_item.set_description(row[</span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158">])
</span></span><span class="line" line="82"><span>
</span></span><span class="line" line="83"><span>
</span></span><span class="line" line="84"><span class="ct-836158">            </span><span class="ct-068318"># write
</span></span><span class="line" line="85"><span class="ct-836158">            r </span><span class="ct-794887">=</span><span class="ct-836158"> wd_item.write(login_instance)
</span></span><span class="line" line="86"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(</span><span class="ct-169668">&quot;goodbye!&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="87"><span>
</span></span><span class="line" line="88"><span class="ct-836158">            </span><span class="ct-068318"># QID is returned
</span></span><span class="line" line="89"><span class="ct-836158">            row[</span><span class="ct-169668">&#39;QID&#39;</span><span class="ct-836158">] </span><span class="ct-794887">=</span><span class="ct-836158"> r
</span></span><span class="line" line="90"><span>
</span></span><span class="line" line="91"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(row[</span><span class="ct-169668">&#39;QID&#39;</span><span class="ct-836158">], row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">])
</span></span><span class="line" line="92"><span>
</span></span><span class="line" line="93"><span>
</span></span><span class="line" line="94"><span class="ct-836158">            complete_data.append(row)
</span></span><span class="line" line="95"><span>
</span></span><span class="line" line="96"><span class="ct-836158">        </span><span class="ct-794887">except</span><span class="ct-836158"> </span><span class="ct-363297">Exception</span><span class="ct-836158"> </span><span class="ct-794887">as</span><span class="ct-836158"> e:
</span></span><span class="line" line="97"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(</span><span class="ct-169668">&quot;There was an error with this part2, skipping:&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="98"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(row)
</span></span><span class="line" line="99"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(e)
</span></span><span class="line" line="100"><span class="ct-836158">            errors_data.append(row)
</span></span><span class="line" line="101"><span class="ct-836158">            data </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&quot;error&quot;
</span></span><span class="line" line="102"><span>
</span></span><span class="line" line="103"><span class="ct-836158">    csv_file.close()
</span></span><span class="line" line="104"><span>
</span></span><span class="line" line="105"><span class="ct-836158">    </span><span class="ct-794887">with</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path</span><span class="ct-794887">+</span><span class="ct-169668">&#39;_updated.csv&#39;</span><span class="ct-836158">,</span><span class="ct-169668">&#39;w&#39;</span><span class="ct-836158">) </span><span class="ct-794887">as</span><span class="ct-836158"> out:
</span></span><span class="line" line="106"><span>
</span></span><span class="line" line="107"><span class="ct-836158">        fieldnames </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">list</span><span class="ct-836158">(complete_data[</span><span class="ct-360247">0</span><span class="ct-836158">].keys())
</span></span><span class="line" line="108"><span class="ct-836158">        writer </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictWriter(out, </span><span class="ct-402719">fieldnames</span><span class="ct-794887">=</span><span class="ct-836158">fieldnames)
</span></span><span class="line" line="109"><span>
</span></span><span class="line" line="110"><span class="ct-836158">        writer.writeheader()
</span></span><span class="line" line="111"><span class="ct-836158">        writer.writerows(complete_data)
</span></span><span class="line" line="112"><span>
</span></span><span class="line" line="113"><span class="ct-836158">    </span><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-363298">len</span><span class="ct-836158">(errors_data) </span><span class="ct-794887">&gt;</span><span class="ct-836158"> </span><span class="ct-360247">0</span><span class="ct-836158">:
</span></span><span class="line" line="114"><span class="ct-836158">        </span><span class="ct-794887">with</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path</span><span class="ct-794887">+</span><span class="ct-169668">&#39;_errors.csv&#39;</span><span class="ct-836158">,</span><span class="ct-169668">&#39;w&#39;</span><span class="ct-836158">) </span><span class="ct-794887">as</span><span class="ct-836158"> out:
</span></span><span class="line" line="115"><span>
</span></span><span class="line" line="116"><span class="ct-836158">            fieldnames </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">list</span><span class="ct-836158">(errors_data[</span><span class="ct-360247">0</span><span class="ct-836158">].keys())
</span></span><span class="line" line="117"><span class="ct-836158">            writer </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictWriter(out, </span><span class="ct-402719">fieldnames</span><span class="ct-794887">=</span><span class="ct-836158">fieldnames)
</span></span><span class="line" line="118"><span>
</span></span><span class="line" line="119"><span class="ct-836158">            writer.writeheader()
</span></span><span class="line" line="120"><span class="ct-836158">            writer.writerows(errors_data)</span></span></code></pre><!--]--><h2 id="_7-ipynb-add-items"><a href="#_7-ipynb-add-items"><!--[-->7. ipynb: ADD ITEMS<!--]--></a></h2><p><!--[-->ADD CORE ITEMS와 코드 동일함<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-794887">import</span><span class="ct-836158"> wikidataintegrator </span><span class="ct-794887">as</span><span class="ct-836158"> </span><span class="ct-360247">WI
</span></span><span class="line" line="2"><span class="ct-794887">import</span><span class="ct-836158"> requests, csv, sys, re
</span></span><span class="line" line="3"><span>
</span></span><span class="line" line="4"><span class="ct-068318">########## part1 ##########
</span></span><span class="line" line="5"><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDItemEngine.core_props </span><span class="ct-794887">=</span><span class="ct-836158"> {
</span></span><span class="line" line="6"><span class="ct-836158">    </span><span class="ct-169668">&#39;P50&#39;</span><span class="ct-836158">: {
</span></span><span class="line" line="7"><span class="ct-836158">        </span><span class="ct-169668">&#39;datatype&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;string&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="8"><span class="ct-836158">        </span><span class="ct-169668">&#39;name&#39;</span><span class="ct-836158">: </span><span class="ct-169668">&#39;식별자&#39;</span><span class="ct-836158">,
</span></span><span class="line" line="9"><span class="ct-836158">        </span><span class="ct-169668">&#39;domain&#39;</span><span class="ct-836158">: [</span><span class="ct-169668">&#39;addresTerms&#39;</span><span class="ct-836158">], </span><span class="ct-068318"># this is a wikidataintergrator thing, to group properties together
</span></span><span class="line" line="10"><span class="ct-836158">        </span><span class="ct-169668">&#39;core_id&#39;</span><span class="ct-836158">: </span><span class="ct-360247">True
</span></span><span class="line" line="11"><span class="ct-836158">    }
</span></span><span class="line" line="12"><span class="ct-836158">}
</span></span><span class="line" line="13"><span>
</span></span><span class="line" line="14"><span class="ct-836158">use_unique_property </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;P8:string&#39;
</span></span><span class="line" line="15"><span>
</span></span><span class="line" line="16"><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-869604">__name__</span><span class="ct-836158"> </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&quot;__main__&quot;</span><span class="ct-836158">:
</span></span><span class="line" line="17"><span>
</span></span><span class="line" line="18"><span class="ct-836158">    csv_path </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;/Users/jeongyunl/Documents/Github/wikibaseintegrator_address_test2/testData/add_core_items.csv&#39;
</span></span><span class="line" line="19"><span class="ct-836158">    csv_file </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path,</span><span class="ct-169668">&#39;r&#39;</span><span class="ct-836158">, </span><span class="ct-402719">encoding</span><span class="ct-794887">=</span><span class="ct-169668">&#39;utf-8-sig&#39;</span><span class="ct-836158">)
</span></span><span class="line" line="20"><span class="ct-836158">    csv_reader </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictReader(csv_file)
</span></span><span class="line" line="21"><span>
</span></span><span class="line" line="22"><span class="ct-836158">    complete_data </span><span class="ct-794887">=</span><span class="ct-836158"> []
</span></span><span class="line" line="23"><span class="ct-836158">    errors_data </span><span class="ct-794887">=</span><span class="ct-836158"> []
</span></span><span class="line" line="24"><span>
</span></span><span class="line" line="25"><span class="ct-836158">    </span><span class="ct-794887">for</span><span class="ct-836158"> row </span><span class="ct-794887">in</span><span class="ct-836158"> csv_reader:
</span></span><span class="line" line="26"><span class="ct-836158">        row </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">dict</span><span class="ct-836158">(row)
</span></span><span class="line" line="27"><span>
</span></span><span class="line" line="28"><span class="ct-836158">        data </span><span class="ct-794887">=</span><span class="ct-836158"> []
</span></span><span class="line" line="29"><span>
</span></span><span class="line" line="30"><span class="ct-836158">        </span><span class="ct-068318"># properties stuff
</span></span><span class="line" line="31"><span class="ct-836158">        </span><span class="ct-794887">for</span><span class="ct-836158"> key </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="32"><span>
</span></span><span class="line" line="33"><span class="ct-836158">            </span><span class="ct-068318"># is it a property field
</span></span><span class="line" line="34"><span class="ct-836158">            </span><span class="ct-794887">if</span><span class="ct-836158"> key.find(</span><span class="ct-169668">&#39;:&#39;</span><span class="ct-836158">) </span><span class="ct-794887">&gt;</span><span class="ct-836158"> </span><span class="ct-794887">-</span><span class="ct-360247">1</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> key[</span><span class="ct-360247">0</span><span class="ct-836158">] </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&quot;P&quot;</span><span class="ct-836158">:
</span></span><span class="line" line="35"><span class="ct-836158">                </span><span class="ct-360247">PID</span><span class="ct-836158">, data_type </span><span class="ct-794887">=</span><span class="ct-836158"> key.split(</span><span class="ct-169668">&#39;:&#39;</span><span class="ct-836158">)
</span></span><span class="line" line="36"><span>
</span></span><span class="line" line="37"><span class="ct-836158">                </span><span class="ct-068318"># there are few other data types need to add...
</span></span><span class="line" line="38"><span class="ct-836158">                </span><span class="ct-794887">try</span><span class="ct-836158">:
</span></span><span class="line" line="39"><span class="ct-836158">                    </span><span class="ct-794887">if</span><span class="ct-836158"> data_type.lower() </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;string&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="40"><span class="ct-836158">                        </span><span class="ct-794887">if</span><span class="ct-836158"> row[key] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[key].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="41"><span class="ct-836158">                            statement </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDString(</span><span class="ct-402719">value</span><span class="ct-794887">=</span><span class="ct-836158">row[key], </span><span class="ct-402719">prop_nr</span><span class="ct-794887">=</span><span class="ct-360247">PID</span><span class="ct-836158">)
</span></span><span class="line" line="42"><span class="ct-836158">                            data.append(statement)
</span></span><span class="line" line="43"><span class="ct-836158">                    </span><span class="ct-794887">elif</span><span class="ct-836158"> data_type.lower() </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;url&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="44"><span class="ct-836158">                        </span><span class="ct-794887">if</span><span class="ct-836158"> row[key] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[key].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="45"><span class="ct-836158">                            statement </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDUrl(</span><span class="ct-402719">value</span><span class="ct-794887">=</span><span class="ct-836158">row[key], </span><span class="ct-402719">prop_nr</span><span class="ct-794887">=</span><span class="ct-360247">PID</span><span class="ct-836158">)
</span></span><span class="line" line="46"><span class="ct-836158">                            data.append(statement)
</span></span><span class="line" line="47"><span class="ct-836158">                    </span><span class="ct-794887">elif</span><span class="ct-836158"> data_type.lower() </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;wikibase-item&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="48"><span class="ct-836158">                        </span><span class="ct-794887">if</span><span class="ct-836158"> row[key] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[key].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="49"><span class="ct-836158">                            statement </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDItemID(</span><span class="ct-402719">value</span><span class="ct-794887">=</span><span class="ct-836158">row[key], </span><span class="ct-402719">prop_nr</span><span class="ct-794887">=</span><span class="ct-360247">PID</span><span class="ct-836158">)
</span></span><span class="line" line="50"><span class="ct-836158">                            data.append(statement)
</span></span><span class="line" line="51"><span>
</span></span><span class="line" line="52"><span>
</span></span><span class="line" line="53"><span class="ct-836158">                </span><span class="ct-794887">except</span><span class="ct-836158"> </span><span class="ct-363297">Exception</span><span class="ct-836158"> </span><span class="ct-794887">as</span><span class="ct-836158"> e:
</span></span><span class="line" line="54"><span class="ct-836158">                    </span><span class="ct-363298">print</span><span class="ct-836158">(</span><span class="ct-169668">&quot;There was an error with this part1, skipping:&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="55"><span class="ct-836158">                    </span><span class="ct-363298">print</span><span class="ct-836158">(row)
</span></span><span class="line" line="56"><span class="ct-836158">                    </span><span class="ct-363298">print</span><span class="ct-836158">(e)
</span></span><span class="line" line="57"><span class="ct-836158">                    errors_data.append(row)
</span></span><span class="line" line="58"><span class="ct-836158">                    data </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&quot;error&quot;
</span></span><span class="line" line="59"><span>
</span></span><span class="line" line="60"><span class="ct-836158">        </span><span class="ct-794887">if</span><span class="ct-836158"> data </span><span class="ct-794887">==</span><span class="ct-836158"> </span><span class="ct-169668">&#39;error&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="61"><span class="ct-836158">            </span><span class="ct-794887">continue
</span></span><span class="line" line="62"><span>
</span></span><span class="line" line="63"><span class="ct-836158">        </span><span class="ct-794887">if</span><span class="ct-836158"> use_unique_property </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="64"><span class="ct-836158">            item_name </span><span class="ct-794887">=</span><span class="ct-836158"> row[use_unique_property]
</span></span><span class="line" line="65"><span class="ct-836158">        </span><span class="ct-794887">else</span><span class="ct-836158">:
</span></span><span class="line" line="66"><span class="ct-836158">            item_name </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">None
</span></span><span class="line" line="67"><span>
</span></span><span class="line" line="68"><span class="ct-068318">########## part2 ##########
</span></span><span class="line" line="69"><span class="ct-836158">        domain </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;addresTerms&#39;
</span></span><span class="line" line="70"><span>
</span></span><span class="line" line="71"><span class="ct-836158">        </span><span class="ct-794887">try</span><span class="ct-836158">:
</span></span><span class="line" line="72"><span class="ct-836158">            wd_item </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-360247">WI</span><span class="ct-836158">.wdi_core.WDItemEngine(</span><span class="ct-402719">new_item</span><span class="ct-794887">=</span><span class="ct-360247">True</span><span class="ct-836158">, </span><span class="ct-402719">data</span><span class="ct-794887">=</span><span class="ct-836158">data, </span><span class="ct-402719">mediawiki_api_url</span><span class="ct-794887">=</span><span class="ct-169668">&quot;http://localhost:4100/w/api.php&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="73"><span>
</span></span><span class="line" line="74"><span class="ct-836158">            </span><span class="ct-068318"># set the label and description if exists
</span></span><span class="line" line="75"><span class="ct-836158">            </span><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158"> </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="76"><span class="ct-836158">                </span><span class="ct-794887">if</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="77"><span class="ct-836158">                    wd_item.set_label(row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">])
</span></span><span class="line" line="78"><span>
</span></span><span class="line" line="79"><span class="ct-836158">            </span><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158"> </span><span class="ct-794887">in</span><span class="ct-836158"> row:
</span></span><span class="line" line="80"><span class="ct-836158">                </span><span class="ct-794887">if</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158">] </span><span class="ct-794887">is</span><span class="ct-836158"> </span><span class="ct-794887">not</span><span class="ct-836158"> </span><span class="ct-360247">None</span><span class="ct-836158"> </span><span class="ct-794887">and</span><span class="ct-836158"> row[</span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158">].strip() </span><span class="ct-794887">!=</span><span class="ct-836158"> </span><span class="ct-169668">&#39;&#39;</span><span class="ct-836158">:
</span></span><span class="line" line="81"><span class="ct-836158">                    wd_item.set_description(row[</span><span class="ct-169668">&#39;Description&#39;</span><span class="ct-836158">])
</span></span><span class="line" line="82"><span>
</span></span><span class="line" line="83"><span>
</span></span><span class="line" line="84"><span class="ct-836158">            </span><span class="ct-068318"># write
</span></span><span class="line" line="85"><span class="ct-836158">            r </span><span class="ct-794887">=</span><span class="ct-836158"> wd_item.write(login_instance)
</span></span><span class="line" line="86"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(</span><span class="ct-169668">&quot;goodbye!&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="87"><span>
</span></span><span class="line" line="88"><span class="ct-836158">            </span><span class="ct-068318"># QID is returned
</span></span><span class="line" line="89"><span class="ct-836158">            row[</span><span class="ct-169668">&#39;QID&#39;</span><span class="ct-836158">] </span><span class="ct-794887">=</span><span class="ct-836158"> r
</span></span><span class="line" line="90"><span>
</span></span><span class="line" line="91"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(row[</span><span class="ct-169668">&#39;QID&#39;</span><span class="ct-836158">], row[</span><span class="ct-169668">&#39;Label&#39;</span><span class="ct-836158">])
</span></span><span class="line" line="92"><span>
</span></span><span class="line" line="93"><span>
</span></span><span class="line" line="94"><span class="ct-836158">            complete_data.append(row)
</span></span><span class="line" line="95"><span>
</span></span><span class="line" line="96"><span class="ct-836158">        </span><span class="ct-794887">except</span><span class="ct-836158"> </span><span class="ct-363297">Exception</span><span class="ct-836158"> </span><span class="ct-794887">as</span><span class="ct-836158"> e:
</span></span><span class="line" line="97"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(</span><span class="ct-169668">&quot;There was an error with this part2, skipping:&quot;</span><span class="ct-836158">)
</span></span><span class="line" line="98"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(row)
</span></span><span class="line" line="99"><span class="ct-836158">            </span><span class="ct-363298">print</span><span class="ct-836158">(e)
</span></span><span class="line" line="100"><span class="ct-836158">            errors_data.append(row)
</span></span><span class="line" line="101"><span class="ct-836158">            data </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-169668">&quot;error&quot;
</span></span><span class="line" line="102"><span>
</span></span><span class="line" line="103"><span class="ct-836158">    csv_file.close()
</span></span><span class="line" line="104"><span>
</span></span><span class="line" line="105"><span class="ct-836158">    </span><span class="ct-794887">with</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path</span><span class="ct-794887">+</span><span class="ct-169668">&#39;_updated.csv&#39;</span><span class="ct-836158">,</span><span class="ct-169668">&#39;w&#39;</span><span class="ct-836158">) </span><span class="ct-794887">as</span><span class="ct-836158"> out:
</span></span><span class="line" line="106"><span>
</span></span><span class="line" line="107"><span class="ct-836158">        fieldnames </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">list</span><span class="ct-836158">(complete_data[</span><span class="ct-360247">0</span><span class="ct-836158">].keys())
</span></span><span class="line" line="108"><span class="ct-836158">        writer </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictWriter(out, </span><span class="ct-402719">fieldnames</span><span class="ct-794887">=</span><span class="ct-836158">fieldnames)
</span></span><span class="line" line="109"><span>
</span></span><span class="line" line="110"><span class="ct-836158">        writer.writeheader()
</span></span><span class="line" line="111"><span class="ct-836158">        writer.writerows(complete_data)
</span></span><span class="line" line="112"><span>
</span></span><span class="line" line="113"><span class="ct-836158">    </span><span class="ct-794887">if</span><span class="ct-836158"> </span><span class="ct-363298">len</span><span class="ct-836158">(errors_data) </span><span class="ct-794887">&gt;</span><span class="ct-836158"> </span><span class="ct-360247">0</span><span class="ct-836158">:
</span></span><span class="line" line="114"><span class="ct-836158">        </span><span class="ct-794887">with</span><span class="ct-836158"> </span><span class="ct-363298">open</span><span class="ct-836158">(csv_path</span><span class="ct-794887">+</span><span class="ct-169668">&#39;_errors.csv&#39;</span><span class="ct-836158">,</span><span class="ct-169668">&#39;w&#39;</span><span class="ct-836158">) </span><span class="ct-794887">as</span><span class="ct-836158"> out:
</span></span><span class="line" line="115"><span>
</span></span><span class="line" line="116"><span class="ct-836158">            fieldnames </span><span class="ct-794887">=</span><span class="ct-836158"> </span><span class="ct-363297">list</span><span class="ct-836158">(errors_data[</span><span class="ct-360247">0</span><span class="ct-836158">].keys())
</span></span><span class="line" line="117"><span class="ct-836158">            writer </span><span class="ct-794887">=</span><span class="ct-836158"> csv.DictWriter(out, </span><span class="ct-402719">fieldnames</span><span class="ct-794887">=</span><span class="ct-836158">fieldnames)
</span></span><span class="line" line="118"><span>
</span></span><span class="line" line="119"><span class="ct-836158">            writer.writeheader()
</span></span><span class="line" line="120"><span class="ct-836158">            writer.writerows(errors_data)</span></span></code></pre><!--]--><br><section class="footnotes" data-footnotes="true"><h2 id="footnote-label" class="sr-only"><a href="#footnote-label"><!--[-->Footnotes<!--]--></a></h2><ol><!--[--><li id="user-content-fn-1"><!--[--><a href="https://sdc-james.gitbook.io/onebook/2./2.1./2.1.1./2-conda-virtual-environments" rel="nofollow"><!--[-->OneBook, conda에서 파이썬 가상 환경 (virtual environments) 생성하기<!--]--></a> <a aria-current="page" href="/blog/2023-03-15-wikibabeintegrator#user-content-fnref-1" class="router-link-active router-link-exact-active data-footnote-backref" aria-label="Back to content" data-footnote-backref="true"><!--[-->↩<!--]--></a><!--]--></li><li id="user-content-fn-2"><!--[-->깃헙 가이드 참고: <a href="https://github.com/wikimedia/pywikibot" rel="nofollow"><!--[-->https://github.com/wikimedia/pywikibot<!--]--></a> <a aria-current="page" href="/blog/2023-03-15-wikibabeintegrator#user-content-fnref-2" class="router-link-active router-link-exact-active data-footnote-backref" aria-label="Back to content" data-footnote-backref="true"><!--[-->↩<!--]--></a><!--]--></li><li id="user-content-fn-3"><!--[--><a href="https://github.com/SemanticLab/data-2-wikibase" rel="nofollow"><!--[-->SemanticLab/data-2-wikibase<!--]--></a> <a aria-current="page" href="/blog/2023-03-15-wikibabeintegrator#user-content-fnref-3" class="router-link-active router-link-exact-active data-footnote-backref" aria-label="Back to content" data-footnote-backref="true"><!--[-->↩<!--]--></a><!--]--></li><!--]--></ol></section><style>.ct-794887{color:#CF222E;}
.dark .ct-794887{color:#FF7B72;}
.sepia .ct-794887{color:#F92672;}
.ct-836158{color:#24292F;}
.dark .ct-836158{color:#C9D1D9;}
.sepia .ct-836158{color:#F8F8F2;}
.ct-169668{color:#0A3069;}
.dark .ct-169668{color:#A5D6FF;}
.sepia .ct-169668{color:#E6DB74;}
.ct-363298{color:#0550AE;}
.dark .ct-363298{color:#79C0FF;}
.sepia .ct-363298{color:#66D9EF;}
.ct-402719{color:#953800;}
.dark .ct-402719{color:#FFA657;}
.sepia .ct-402719{color:#FD971F;font-style:italic;}
.ct-068318{color:#6E7781;}
.dark .ct-068318{color:#8B949E;}
.sepia .ct-068318{color:#88846F;}
.ct-854774{color:#CF222E;}
.dark .ct-854774{color:#FF7B72;}
.sepia .ct-854774{color:#66D9EF;font-style:italic;}
.ct-417962{color:#8250DF;}
.dark .ct-417962{color:#D2A8FF;}
.sepia .ct-417962{color:#A6E22E;}
.ct-341470{color:#24292F;}
.dark .ct-341470{color:#C9D1D9;}
.sepia .ct-341470{color:#FD971F;font-style:italic;}
.ct-869604{color:#0550AE;}
.dark .ct-869604{color:#79C0FF;}
.sepia .ct-869604{color:#F8F8F2;}
.ct-363297{color:#0550AE;}
.dark .ct-363297{color:#79C0FF;}
.sepia .ct-363297{color:#66D9EF;font-style:italic;}
.ct-360247{color:#0550AE;}
.dark .ct-360247{color:#79C0FF;}
.sepia .ct-360247{color:#AE81FF;}</style></div></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400"> Tags </h2><div class="flex flex-wrap"><!--[--><a href="/tags/wikibase" class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">Wikibase</a><a href="/tags/docker" class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">Docker</a><a href="/tags/wikibaseintegrator" class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">WikibaseIntegrator</a><!--]--></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400"> Previous Article </h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/2023-03-10-wikibase" class="">&lt;Mediawiki-1&gt; Docker로 Wikibase 설치하기</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400"> Next Article </h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/2023-04-11-python-virtual" class="">Mac Python 가상환경 설정하기</a></div></div></div></div><div class="pt-4 xl:pt-8"><a href="/blog" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"> ← Back to the blog </a></div></footer></div></div></article><!--]--></div><!--]--></main><footer><div class="mt-16 mb-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:cathx618@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400" style="" width="24" height="24" viewBox="0 0 24 24" data-v-f43f2976><path fill="currentColor" d="M22 8.608v8.142a3.25 3.25 0 0 1-3.066 3.245L18.75 20H5.25a3.25 3.25 0 0 1-3.245-3.066L2 16.75V8.608l9.652 5.056a.75.75 0 0 0 .696 0L22 8.608ZM5.25 4h13.5a3.25 3.25 0 0 1 3.234 2.924L12 12.154l-9.984-5.23a3.25 3.25 0 0 1 3.048-2.919L5.25 4h13.5h-13.5Z"/></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/JeongYunLee"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400" style="" width="24" height="24" viewBox="0 0 24 24" data-v-f43f2976><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/%EC%A0%95%EC%9C%A4-%EC%9D%B4-50822922a/"><span class="sr-only">linkedin</span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400" style="" width="24" height="24" viewBox="0 0 24 24" data-v-f43f2976><path fill="currentColor" d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037c-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85c3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065a2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>JeongYun Lee</div><div> • </div><div>© 2023</div><div> • </div><a href="/" class="">jyunlee.com</a></div></div></footer></div><!--]--></div><!--]--><!--]--></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/blog/2023-03-15-wikibabeintegrator/_payload.json">[{"state":1,"_errors":16,"serverRendered":5,"prerenderedAt":19},["Reactive",2],{"$scolor-mode":3,"$sicons":7},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,{"fluent:mail-24-filled":8,"simple-icons:github":12,"simple-icons:linkedin":14},{"left":9,"top":9,"width":10,"height":10,"rotate":9,"vFlip":6,"hFlip":6,"body":11},0,24,"\u003Cpath fill=\"currentColor\" d=\"M22 8.608v8.142a3.25 3.25 0 0 1-3.066 3.245L18.75 20H5.25a3.25 3.25 0 0 1-3.245-3.066L2 16.75V8.608l9.652 5.056a.75.75 0 0 0 .696 0L22 8.608ZM5.25 4h13.5a3.25 3.25 0 0 1 3.234 2.924L12 12.154l-9.984-5.23a3.25 3.25 0 0 1 3.048-2.919L5.25 4h13.5h-13.5Z\"/>",{"left":9,"top":9,"width":10,"height":10,"rotate":9,"vFlip":6,"hFlip":6,"body":13},"\u003Cpath fill=\"currentColor\" d=\"M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"/>",{"left":9,"top":9,"width":10,"height":10,"rotate":9,"vFlip":6,"hFlip":6,"body":15},"\u003Cpath fill=\"currentColor\" d=\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037c-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85c3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065a2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"/>",["Reactive",17],{"content-/blog/2023-03-15-wikibabeintegrator":18},null,1696488123589]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{locales:[],defaultLocale:"",integrity:1696488113932,experimental:{stripQueryParameters:false,clientDB:false},api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"prose-code",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{default:"github-light",dark:"github-dark",sepia:"monokai"}},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script type="module" src="/_nuxt/entry.4e7d7028.js" crossorigin></script></body>
</html>